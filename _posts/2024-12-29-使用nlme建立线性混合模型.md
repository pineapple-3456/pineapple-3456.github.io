---
layout: post
title: 毕业论文笔记1｜使用nlme建立线性混合模型
date: 2024-12-29 11:12:00
description: 
tags: 心理学
categories:  
related_posts: true
---

## 线性混合模型

社会科学研究中的数据经常具有层次结构，过去分析层次结构数据容易产生的一个问题是汇总偏差，即将不同组织的数据错误地纳入同一个模型中。例如对不同学校的学生的调查显示，学生的某种特质X可能会影响到学习成绩Y，然而X对Y的回归系数却不是恒定的，而是在不同学校间存在有统计意义的差异。线性混合模型的出现就是为了应对这种问题。应对的策略是允许X对Y的回归系数在一定范围内变化。

考虑以上的以上的例子，使用普通的ols回归可以建立回归方程：

$$
Y_i = \beta_0 + \beta_1X_i + e_i
$$

其中$$i$$代表第$$i$$个学生个体，而线性混合模型可以允许回归系数具有一定的变化范围，注意后两行的因变量是第一行的回归系数：

$$
\begin{align}
& Y_{ij} = \beta_{0j} + \beta_{1j}X_{ij} + r_{ij} \\
& \beta_{0j} = \gamma_{00} + u_{0j} \\
& \beta_{1j} = \gamma_{10} + u_{1j}
\end{align}
$$

其中 $$j$$ 表示第 $$j$$ 个学校，r_{ij}表示学生水平的误差，u_{0j}和u_{1j}表示学校水平截距和斜率上的误差。如果$$\beta_0$$和$$\beta_1$$还能够被学校特征W预测，那么普通ols回归方程为：

$$
Y_i = \beta_0 + \beta_1X_i + \beta_2W_j + \beta_3X_iW_j+ e_i
$$

线性混合模型的方程为：

$$
\begin{align}
& Y_{ij} = \beta_{0j} + \beta_{1j}X_{ij} + r_{ij} \\
& \beta_{0j} = \gamma_{00} + \gamma_{01}W_{j} + u_{0j} \\
& \beta_{1j} = \gamma_{10} + \gamma_{11}W_{j} + u_{1j}
\end{align}
$$

将混合模型分成不同水平来写是为了便于理解，实际上也可以合并在一起：

$$
Y_{ij} = \gamma_{00} + \gamma_{10}X_{ij} + \gamma_{01}W_{j} + \gamma_{11}X_{ij}W_{j} + u_{0j} + u_{1j}X_{ij} + r_{ij} 
$$

对比普通ols回归方程，可以发现二者的区别在于原本的误差项$$e_i$$变为$$u_{1j}X_{ij} + r_{ij}$$。




